window.Harmony||(window.Harmony={});
Harmony.UI=window.Harmony.UI={LOADING:"loading",OUTPUT:"output",_fields:[],addField:function(a,b){null!=b&&(Harmony.UI._fields[a]=b.length?b[0]:b)},addressLookup:function(a,b,c){Harmony.UI.addField(Harmony.ADDRESS,a);if(Harmony.UI._checkDependencies()){var e="undefined"!=typeof c?c:{};e.source=function(a,c){var e=Harmony.UI._getSourceOfTruth(b),k={fullAddress:Harmony.UI._getFieldValue(Harmony.ADDRESS)};Harmony.UI._setLoading(Harmony.ADDRESS,!0);Harmony.address(k,e,function(a){for(var b=[],g,e=0;e<
a.payload.length;e++)g=a.payload[e],g.label=g.fullAddress,g.value=g.fullAddress,b[b.length]=g;c(b);Harmony.UI._setLoading(Harmony.ADDRESS,!1)})};e.select=function(c,f){a.value=f.item.value;if(e.skipTransaction)Harmony.UI._setFieldValues(f.item);else{var h=Harmony.UI._getSourceOfTruth(b);Harmony.transaction(h,function(){Harmony.UI._setFieldValues(f.item)})}if(e.onSelect)e.onSelect(c,f)};Harmony.UI._autocomplete(a,e)}},buildingNameLookup:function(a,b,c){Harmony.UI._checkDependencies()&&(c="undefined"!=
typeof c?c:{},Harmony.UI.addField(Harmony.BUILDING_NAME,a),c.source=function(a,c){var f=Harmony.UI._getSourceOfTruth(b);Harmony.UI._setLoading(Harmony.BUILDING_NAME,!0);Harmony.buildingName(Harmony.UI._getAddress(f),f,function(a){for(var b=[],d,e=0;e<a.payload.length;e++)d=a.payload[e],d.label=d.buildingName+", "+d.streetNumber+" "+d.street+("undefined"!==typeof d.locality?", "+d.locality:"")+("undefined"!==typeof d.suburb?", "+d.suburb:"")+("undefined"!==typeof d.townCity?", "+d.townCity:""),d.value=
d.buildingName,b[b.length]=d;c(b);Harmony.UI._setLoading(Harmony.BUILDING_NAME,!1)})},c.select=function(c,b){a.value=b.item.value;b.item.subdwelling="";Harmony.UI._setFieldValues(b.item)},Harmony.UI._autocomplete(a,c))},floorLevelTypeSelect:function(a,b){var c=Harmony.UI._getSourceOfTruth(b);Harmony.Types.floorLevel(c,function(c){Harmony.UI._populateSelect(a,c)})},localityLookup:function(a,b,c){Harmony.UI._checkDependencies()&&(c="undefined"!=typeof c?c:{},Harmony.UI.addField(Harmony.LOCALITY,a),
c.source=function(a,c){var f=Harmony.UI._getSourceOfTruth(b);Harmony.UI._setLoading(Harmony.LOCALITY,!0);Harmony.locality(Harmony.UI._getAddress(f),f,function(a){for(var b=[],d,e=0;e<a.payload.length;e++)d=a.payload[e],d.label=d.locality+" ("+d.postcode+" "+("undefined"!=typeof d.townCity?d.townCity:d.state)+")",d.value=d.locality,b[b.length]=d;c(b);Harmony.UI._setLoading(Harmony.LOCALITY,!1)})},c.select=function(c,b){a.value=b.item.value;Harmony.UI._setFieldValue(Harmony.POSTCODE,b.item.postcode)},
Harmony.UI._autocomplete(a,c))},parseAddress:function(){Harmony.UI._setLoading(Harmony.ADDRESS,!0);Harmony.Parse.address(Harmony.UI._getFieldValue(Harmony.ADDRESS),function(a){a.status==Harmony.SUCCESS?null==a.payload[0].exception?(Harmony.UI._clearOutput(),Harmony.UI._setFieldValues(a.payload[0])):(Harmony.UI._clearFieldValues(),Harmony.UI._error(a.payload[0].exception)):Harmony.UI._error(a.message);Harmony.UI._setLoading(Harmony.ADDRESS,!1)})},postalLookup:function(a,b,c){Harmony.UI._checkDependencies()&&
(c="undefined"!=typeof c?c:{},Harmony.UI.addField(Harmony.POSTAL,a),c.source=function(a,c){var f=Harmony.UI._getSourceOfTruth(b);Harmony.UI._setLoading(Harmony.POSTAL,!0);Harmony.postal(Harmony.UI._getAddress(f),f,function(a){for(var b=[],d,e=0;e<a.payload.length;e++)d=a.payload[e],d.label=d.postal,d.value=d.postal,b[b.length]=d;c(b);Harmony.UI._setLoading(Harmony.POSTAL,!1)})},c.select=function(b,c){a.value=c.item.value;Harmony.UI._setFieldValues(c.item)},Harmony.UI._autocomplete(a,c))},postalTypeSelect:function(a,
b){var c=Harmony.UI._getSourceOfTruth(b);Harmony.Types.postal(c,function(b){Harmony.UI._populateSelect(a,b)})},postcodeLookup:function(a,b,c){Harmony.UI.addField(Harmony.POSTCODE,a);Harmony.UI._checkDependencies()&&(c="undefined"!=typeof c?c:{},c.source=function(a,c){var f=Harmony.UI._getSourceOfTruth(b);Harmony.UI._setLoading(Harmony.POSTCODE,!0);Harmony.postcode(Harmony.UI._getAddress(f),f,function(a){for(var b=[],d,e,f=0;f<a.payload.length;f++)d=a.payload[f],e="undefined"!=typeof d.suburb?d.suburb:
"undefined"!=typeof d.locality?d.locality:"",e+=(""!=e?" ":"")+("undefined"!=typeof d.townCity?d.townCity:"undefined"!=typeof d.state?d.state:""),d.label=d.postcode+" ("+e+")",d.value=d.postcode,b[b.length]=d;c(b);Harmony.UI._setLoading(Harmony.POSTCODE,!1)})},c.select=function(b,c){a.value=c.item.value;Harmony.UI._setFieldValues(c.item)},Harmony.UI._autocomplete(a,c))},setOutputElement:function(a){Harmony.UI.addField(Harmony.UI.OUTPUT,a)},streetLookup:function(a,b,c){Harmony.UI.addField(Harmony.STREET,
a);Harmony.UI._checkDependencies()&&(c="undefined"!=typeof c?c:{},c.source=function(a,c){var f=Harmony.UI._getSourceOfTruth(b);Harmony.UI._setLoading(Harmony.STREET,!0);Harmony.street(Harmony.UI._getAddress(f),f,function(a){for(var b=[],d=0;d<a.payload.length;d++){var e=a.payload[d];e.label=e.street+", "+("undefined"!=typeof e.suburb?e.suburb:e.locality);e.value=e.street;b[b.length]=e}c(b);Harmony.UI._setLoading(Harmony.STREET,!1)})},c.select=function(b,c){a.value=c.item.value;Harmony.UI._setFieldValues(c.item)},
Harmony.UI._autocomplete(a,c))},streetNumberLookup:function(a,b,c){Harmony.UI.addField(Harmony.STREET_NUMBER,a);Harmony.UI._checkDependencies()&&(c="undefined"!=typeof c?c:{},c.source=function(a,c){var f=Harmony.UI._getSourceOfTruth(b);Harmony.UI._setLoading(Harmony.STREET_NUMBER,!0);Harmony.streetNumber(Harmony.UI._getAddress(f),f,function(a){for(var b=[],d,e=0;e<a.payload.length;e++)d=a.payload[e],d.label=d.streetNumber+" "+d.street,d.value=$.trim(d.streetNumber),b[b.length]=d;c(b);Harmony.UI._setLoading(Harmony.STREET_NUMBER,
!1)})},c.select=function(b,c){a.value=c.item.value;c.item.subdwelling="";Harmony.UI._setFieldValues(c.item)},Harmony.UI._autocomplete(a,c))},streetSuffixTypeSelect:function(a,b){var c=Harmony.UI._getSourceOfTruth(b);Harmony.Types.streetSuffix(c,function(b){Harmony.UI._populateSelect(a,b)})},streetTypeSelect:function(a,b){var c=Harmony.UI._getSourceOfTruth(b);Harmony.Types.street(c,function(b){Harmony.UI._populateSelect(a,b)})},subdwellingLookup:function(a,b,c){Harmony.UI.addField(Harmony.SUBDWELLING,
a);Harmony.UI._checkDependencies()&&(c="undefined"!=typeof c?c:{},c.source=function(a,c){var f=Harmony.UI._getSourceOfTruth(b);Harmony.UI._setLoading(Harmony.SUBDWELLING,!0);Harmony.subdwelling(Harmony.UI._getAddress(f),f,function(a){for(var b=[],d,e=0;e<a.payload.length;e++)d=a.payload[e],d.label=d.fullAddress,d.value=$.trim(d.subdwelling),b[b.length]=d;c(b);Harmony.UI._setLoading(Harmony.SUBDWELLING,!1)})},c.select=function(b,c){a.value=c.item.value;Harmony.UI._setFieldValues(c.item)},Harmony.UI._autocomplete(a,
c))},suburbLookup:function(a,b,c){Harmony.UI.addField(Harmony.SUBURB,a);Harmony.UI._checkDependencies()&&(c="undefined"!=typeof c?c:{},c.source=function(a,c){var f=Harmony.UI._getSourceOfTruth(b);Harmony.UI._setLoading(Harmony.SUBURB,!0);Harmony.suburb(Harmony.UI._getAddress(f),f,function(a){for(var b=[],d,e=0;e<a.payload.length;e++)d=a.payload[e],d.label=d.suburb+", "+d.townCity+" ("+d.postcode+")",d.value=d.suburb,b[b.length]=d;c(b);Harmony.UI._setLoading(Harmony.SUBURB,!1)})},c.select=function(b,
c){a.value=c.item.value;Harmony.UI._setFieldValues(c.item)},Harmony.UI._autocomplete(a,c))},townCityLookup:function(a,b,c){Harmony.UI.addField(Harmony.TOWN_CITY,a);Harmony.UI._checkDependencies()&&(c="undefined"!=typeof c?c:{},c.source=function(a,c){var f=Harmony.UI._getSourceOfTruth(b);Harmony.UI._setLoading(Harmony.TOWN_CITY,!0);Harmony.townCity(Harmony.UI._getAddress(f),f,function(a){for(var b=[],d,e=0;e<a.payload.length;e++)d=a.payload[e],d.label=d.townCity+" ("+(""!=d.suburb?d.suburb+", ":"")+
d.postcode+")",d.value=d.townCity,b[b.length]=d;c(b);Harmony.UI._setLoading(Harmony.TOWN_CITY,!1)})},c.select=function(b,c){a.value=c.item.value;Harmony.UI._setFieldValues(c.item)},Harmony.UI._autocomplete(a,c))},unitFlatTypeSelect:function(a,b){var c=Harmony.UI._getSourceOfTruth(b);Harmony.Types.unitFlat(c,function(b){Harmony.UI._populateSelect(a,b)})},identifyAddress:function(){Harmony.UI._setLoading(Harmony.EID,!0);Harmony.Extensions.identify({eid:Harmony.UI._getFieldValue(Harmony.EID)},function(a){null!=
a?Harmony.UI._setFieldValues(a.payload[0]):Harmony.UI._error("Failed to identify address");Harmony.UI._setLoading(Harmony.EID,!1)})},_addSelectOption:function(a,b,c){var e=document.createElement("option");e.text=b;e.value=c;a.add(e)},_autocomplete:function(a,b){window.$(a).autocomplete(b)},_checkDependencies:function(){var a=!0;window.Harmony||(alert("Harmony JavaScript library is required"),a=!1);window.jQuery||(alert("jQuery is required"),a=!1);"undefined"!=typeof jQuery.autocomplete&&(alert("jQuery UI Autocomplete is required"),
a=!1);return a},_clearFieldValues:function(){Harmony.UI._setFieldValues({})},_clearOutput:function(){Harmony.UI._error("")},_error:function(a){var b=Harmony.UI._getField(Harmony.UI.OUTPUT);null!=b&&("undefined"!=typeof b.value?b.value=a:$(b).html(a))},_getAddress:function(a){a=Harmony.UI._getSourceOfTruthCountry(a);var b={};null!=Harmony.UI._getField(Harmony.POSTCODE)&&(b.postcode=Harmony.UI._getFieldValue(Harmony.POSTCODE));a==Harmony.AUSTRALIA&&null!=Harmony.UI._getField(Harmony.LOCALITY)&&(b.locality=
Harmony.UI._getFieldValue(Harmony.LOCALITY));a==Harmony.NEW_ZEALAND&&null!=Harmony.UI._getField(Harmony.TOWN_CITY)&&(b.townCity=Harmony.UI._getFieldValue(Harmony.TOWN_CITY));a==Harmony.NEW_ZEALAND&&null!=Harmony.UI._getField(Harmony.SUBURB)&&(b.suburb=Harmony.UI._getFieldValue(Harmony.SUBURB),b.locality=b.suburb);null!=Harmony.UI._getField(Harmony.STREET)&&(b.street=Harmony.UI._getFieldValue(Harmony.STREET));null!=Harmony.UI._getField(Harmony.STREET_NUMBER)&&(b.streetNumber=Harmony.UI._getFieldValue(Harmony.STREET_NUMBER));
null!=Harmony.UI._getField(Harmony.SUBDWELLING)&&(b.subdwelling=Harmony.UI._getFieldValue(Harmony.SUBDWELLING));null!=Harmony.UI._getField(Harmony.POSTAL)&&(b.postal=Harmony.UI._getFieldValue(Harmony.POSTAL));null!=Harmony.UI._getField(Harmony.BUILDING_NAME)&&(b.buildingName=Harmony.UI._getFieldValue(Harmony.BUILDING_NAME));return b},_getField:function(a){return Harmony.UI._fields[a]},_getFieldValue:function(a){a=$(Harmony.UI._getField(a));var b="";a.length&&(b=a.val());return b},_getSourceOfTruth:function(a){var b=
Harmony.UI._getFieldValue(Harmony.SOURCE_OF_TRUTH);if("undefined"==typeof b||""==b)b=a;return b},_getSourceOfTruthCountry:function(a){var b=null;a==Harmony.AUSOTS||a==Harmony.AUPAF||a==Harmony.GNAF?b=Harmony.AUSTRALIA:a==Harmony.NZPAF&&(b=Harmony.NEW_ZEALAND);return b},_populateSelect:function(a,b){var c;if("undefined"!=typeof b&&"undefined"!=typeof b.payload)for(c=0;c<b.payload.length;c++)Harmony.UI._addSelectOption(a,b.payload[c].name,b.payload[c].value);else Harmony.UI._addSelectOption(a,"No data available",
0)},_setFieldValue:function(a,b){var c=Harmony.UI._getField(a);null!=c&&(c.value="undefined"!=typeof b?b:"")},_setFieldValues:function(a){var b="";if("undefined"!=typeof a){Harmony.UI._setFieldValue(Harmony.EID,a.eid);Harmony.UI._setFieldValue(Harmony.POSTCODE,a.postcode);Harmony.UI._setFieldValue(Harmony.STATE,a.state);Harmony.UI._setFieldValue(Harmony.LOCALITY,a.locality);Harmony.UI._setFieldValue(Harmony.TOWN_CITY,a.townCity);Harmony.UI._setFieldValue(Harmony.SUBURB,a.suburb);Harmony.UI._setFieldValue(Harmony.STREET,
a.street);Harmony.UI._setFieldValue(Harmony.STREET_2,a.street2);Harmony.UI._setFieldValue(Harmony.STREET_NUMBER,a.streetNumber);Harmony.UI._setFieldValue(Harmony.POSTAL,a.postal);Harmony.UI._setFieldValue(Harmony.BUILDING_NAME,a.buildingName);Harmony.UI._setFieldValue(Harmony.SUBDWELLING,a.subdwelling);Harmony.UI._setFieldValue(Harmony.CARE_OF,a.careOf);Harmony.UI._setFieldValue(Harmony.ADDRESS,a.fullAddress);Harmony.UI._setFieldValue(Harmony.ID,a.id);Harmony.UI._setFieldValue(Harmony.FLOOR_LEVEL_TYPE,
a.floorLevelType);Harmony.UI._setFieldValue(Harmony.FLOOR_LEVEL_NUMBER,a.floorLevelNumber);Harmony.UI._setFieldValue(Harmony.FLAT_UNIT_TYPE,a.flatUnitType);Harmony.UI._setFieldValue(Harmony.FLAT_UNIT_NUMBER,a.flatUnitNumber);Harmony.UI._setFieldValue(Harmony.LOT_NUMBER,a.lotNumber);Harmony.UI._setFieldValue(Harmony.STREET_NAME,a.streetName);Harmony.UI._setFieldValue(Harmony.STREET_TYPE,a.streetType);Harmony.UI._setFieldValue(Harmony.STREET_SUFFIX,a.streetSuffix);for(var c in a.attributes)b+=(""==
b?"":", ")+c+": "+a.attributes[c];Harmony.UI._setFieldValue(Harmony.ATTRIBUTES,b)}},_setLoading:function(a,b){var c=$(Harmony.UI._getField(a));b?c.addClass(Harmony.UI.LOADING):c.removeClass(Harmony.UI.LOADING)}};